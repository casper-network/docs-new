"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[8109],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),p=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=p(e.components);return a.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),u=p(n),g=r,h=u["".concat(c,".").concat(g)]||u[g]||d[g]||i;return n?a.createElement(h,s(s({ref:t},l),{},{components:n})):a.createElement(h,s({ref:t},l))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=g;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[u]="string"==typeof e?e:r,s[1]=o;for(var p=2;p<i;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},3656:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return u}});var a=n(3117),r=n(102),i=(n(7294),n(3905)),s=["components"],o={},c="Casper Signer in dApp Development",p={unversionedId:"dapp-dev-guide/building-dapps/signer-integration",id:"dapp-dev-guide/building-dapps/signer-integration",title:"Casper Signer in dApp Development",description:"The Casper Signer is a wallet developed by the teams at MAKE and CasperLabs for using Casper accounts. You can interact with the Casper Signer using the Signer (Reword this for god sakes).",source:"@site/source/docs/casper/dapp-dev-guide/building-dapps/signer-integration.md",sourceDirName:"dapp-dev-guide/building-dapps",slug:"/dapp-dev-guide/building-dapps/signer-integration",permalink:"/dapp-dev-guide/building-dapps/signer-integration",draft:!1,editUrl:"https://github.com/casper-network/docs/tree/main/source/docs/casper/dapp-dev-guide/building-dapps/signer-integration.md",tags:[],version:"current",lastUpdatedAt:1679410447,formattedLastUpdatedAt:"Mar 21, 2023",frontMatter:{}},l={},u=[{value:"Integration",id:"integration",level:2},{value:"Create Vaults &amp; Accounts",id:"create-vaults--accounts",level:2},{value:"Get Account Public Key",id:"get-account-public-key",level:2},{value:"Signing Messages and Transactions",id:"signing-messages-and-transactions",level:2},{value:"Sign Message",id:"sign-message",level:3},{value:"Sign Transaction",id:"sign-transaction",level:3},{value:"Disconnecting",id:"disconnecting",level:2}],d={toc:u},g="wrapper";function h(e){var t=e.components,n=(0,r.Z)(e,s);return(0,i.kt)(g,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"casper-signer-in-dapp-development"},"Casper Signer in dApp Development"),(0,i.kt)("p",null,"The Casper Signer is a wallet developed by the teams at MAKE and CasperLabs for using Casper accounts. You can interact with the Casper Signer using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Signer")," (Reword this for god sakes)."),(0,i.kt)("h2",{id:"integration"},"Integration"),(0,i.kt)("p",null,"To connect to the Casper Signer from a dApp's front-end is simple. Start by importing the ",(0,i.kt)("inlineCode",{parentName:"p"},"Signer")," class from the Casper JS SDK."),(0,i.kt)("p",null,"Using ES5 syntax:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const { Signer } = require("casper-js-sdk");\n')),(0,i.kt)("p",null,"Using ES6:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'import { Signer } from "casper-js-sdk";\n')),(0,i.kt)("p",null,"You can then use the ",(0,i.kt)("inlineCode",{parentName:"p"},"Signer")," class to send a connection request to the Casper Signer:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.sendConnectionRequest();\n")),(0,i.kt)("p",null,"and check if the Casper Signer is connected using:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.isConnected();\n")),(0,i.kt)("h2",{id:"create-vaults--accounts"},"Create Vaults & Accounts"),(0,i.kt)("p",null,"You can use available JavaScript methods to create new vaults and accounts within the Signer. A vault is a wallet that may hold many accounts, whereas an account is an entity with a single public and private key that can interact with the Casper Network."),(0,i.kt)("p",null,"To check if the user has created a vault, read the boolean result of the promissory function :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.hasCreatedVault();\n")),(0,i.kt)("p",null,"To create a new vault, call the following function, providing a password for the vault:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'Signer.createNewVault("password");\n')),(0,i.kt)("p",null,"You may also create a test account that will remain persistent in the Signer using the function:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'Signer.createTestAccount("Account Name", privateKey);\n')),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"privateKey")," is the base 16 private key of the account as a ",(0,i.kt)("inlineCode",{parentName:"p"},"string")),(0,i.kt)("h2",{id:"get-account-public-key"},"Get Account Public Key"),(0,i.kt)("p",null,"There are two available methods for getting the active account's public key, in different formats. There are many reasons you may want to read the public key of the active account, the main being the use it in a smart contract call or query."),(0,i.kt)("p",null,"To get the account public key in hexadecimal format, execute:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.getActivePublicKey();\n")),(0,i.kt)("p",null,"This function resolves to a ",(0,i.kt)("inlineCode",{parentName:"p"},"string"),", or rejects with an error."),(0,i.kt)("p",null,"To get the public key in base 64, run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.getSelectedPublicKeyBase64();\n")),(0,i.kt)("p",null,"Note that this function is deprecated in favor of ",(0,i.kt)("inlineCode",{parentName:"p"},"getActivePublicKey()"),". It is recommended to use ",(0,i.kt)("inlineCode",{parentName:"p"},"getActivePublicKey()")," and convert to base 64."),(0,i.kt)("h2",{id:"signing-messages-and-transactions"},"Signing Messages and Transactions"),(0,i.kt)("h3",{id:"sign-message"},"Sign Message"),(0,i.kt)("p",null,"When a message is signed with a Casper account, it serves as a proof that the message was sent by the owner of that account, and that the message has not been tampered with since it was signed. The signature is generated using the account's private key, which only the owner of the account should have access to. The signature can then be verified by anyone who has access to the message, the signature, and the public key associated with the Casper account."),(0,i.kt)("p",null,"To sign a given message using the Casper JS SDK, initiate a signature request using this function:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'Signer.signMessage("Message to be signed", publicKey);\n')),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"publicKey")," is the base 16 ",(0,i.kt)("inlineCode",{parentName:"p"},"string"),"-typed public key of the active account within the Casper Signer."),(0,i.kt)("h3",{id:"sign-transaction"},"Sign Transaction"),(0,i.kt)("p",null,"Transactions can be forwarded to the Casper Signer to be signed by a user without the user needing to reveal their private key to the application. To accomplish this, convert a valid, unsigned ",(0,i.kt)("inlineCode",{parentName:"p"},"Deploy")," object to JSON and call the ",(0,i.kt)("inlineCode",{parentName:"p"},"sign")," method on the ",(0,i.kt)("inlineCode",{parentName:"p"},"Signer")," class:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const publicKeyHex = await Signer.getActivePublicKey();\n\nconst unsignedDeploy = contract.callEntrypoint(\n    "test_entrypoint",\n    runtimeArguments,\n    CLPublicKey.fromHex(publicKeyHex),\n    "casper", // Or "casper-test" for testnet\n    "1000000000", // Gas payment, 10^9 motes or 1 CSPR\n    [], // Empty signing-keys array\n);\n\nconst unsignedDeployJSON = DeployUtil.deployToJSON(unsignedDeploy);\n\nconst signedDeployJSON = await Signer.sign(unsignedDeployJSON, publicKeyHex);\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"sign")," function throws an error if the Casper Signer is not connected (see ",(0,i.kt)("inlineCode",{parentName:"p"},"isConnected"),") or if the signing public key (",(0,i.kt)("inlineCode",{parentName:"p"},"publicKeyHex")," above) does not match the active public key in the Signer."),(0,i.kt)("p",null,"Once you have the ",(0,i.kt)("inlineCode",{parentName:"p"},"signedDeployJSON")," you can craft a ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST"},"POST request")," to your dApp's backend, passing along the signed JSON deploy in the body. Be sure to set the ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," header to ",(0,i.kt)("inlineCode",{parentName:"p"},"application/json"),"."),(0,i.kt)("h2",{id:"disconnecting"},"Disconnecting"),(0,i.kt)("p",null,"After connecting the Casper Signer to your dApp, you may at some point want to disconnect. There is a method available for this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"Signer.disconnectFromSite();\n")))}h.isMDXComponent=!0}}]);