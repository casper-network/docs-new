<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="search" type="application/opensearchdescription+xml" title="Casper" href="/opensearch.xml"><title data-rh="true">Writing a Basic Smart Contract in Rust | Casper</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://operators.casper.network//dapp-dev-guide/writing-contracts/rust-contracts/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Writing a Basic Smart Contract in Rust | Casper"><meta data-rh="true" name="description" content="What is a Smart Contract?"><meta data-rh="true" property="og:description" content="What is a Smart Contract?"><link data-rh="true" rel="icon" href="/icon/favicon.ico"><link data-rh="true" rel="canonical" href="https://operators.casper.network//dapp-dev-guide/writing-contracts/rust-contracts/"><link data-rh="true" rel="alternate" href="https://operators.casper.network//dapp-dev-guide/writing-contracts/rust-contracts/" hreflang="en"><link data-rh="true" rel="alternate" href="https://operators.casper.network//dapp-dev-guide/writing-contracts/rust-contracts/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KQNX60E7J5-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ab16f509.css">
<link rel="preload" href="/assets/js/runtime~main.aea1ae3e.js" as="script">
<link rel="preload" href="/assets/js/main.aa97aa2a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icon/Casper_Wordmark_Red_RGB.png" alt="Casper Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/icon/Casper_Wordmark_White_RGB.png" alt="Casper Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/workflow/">How To&#x27;s</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dapp-dev-guide/">Developers</a><a class="navbar__item navbar__link" href="/operators/">Operators</a><a class="navbar__item navbar__link" href="/design/">Design</a><a class="navbar__item navbar__link" href="/economics/">Economics</a><a class="navbar__item navbar__link" href="/staking/">Staking</a><a class="navbar__item navbar__link" href="/glossary/">Glossary</a><a class="navbar__item navbar__link" href="/faq/">FAQ</a><a href="https://discord.com/invite/Q38s3Vh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/dapp-dev-guide/writing-contracts/rust-contracts/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><a href="https://github.com/casper-network/docs-app" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp-dev-guide/build-on-casper/introduction/">Why Build on Casper</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/keys/">Accounts and Cryptographic Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/understanding-hash-types/">Understanding Hash Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/json-rpc/">Interacting with the Casper JSON-RPC API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp-dev-guide/sdkspec/introduction/">Casper SDK Standard</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/list-cspr/">Listing CSPR on Your Exchange</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/setup/">Development Prerequisites</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp-dev-guide/building-dapps/signing-a-deploy/">Building dApps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/writing-contracts/">Writing On-Chain Code</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writing-contracts/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/getting-started/">Getting Started with Rust</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/best-practices/">Best Practices for Casper Smart Contract Authors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dapp-dev-guide/writing-contracts/rust-contracts/">Writing a Basic Smart Contract in Rust</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/testing-contracts/">Testing Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/contract-vs-session/">Contracts and Session Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/session-code/">Writing Session Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/testing-session-code/">Testing Session Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/installing-contracts/">Installing Smart Contracts and Querying Global State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/calling-contracts/">Calling Smart Contracts with the Rust Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/upgrading-contracts/">Upgrading and Maintaining Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/dictionaries/">Reading and Writing to Dictionaries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/execution-error-codes/">Execution Error Codes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/writing-contracts/assembly-script/">Getting Started with AssemblyScript</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/tutorials/">Tutorials</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">🏠</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Writing On-Chain Code</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/dapp-dev-guide/writing-contracts/rust-contracts/">Writing a Basic Smart Contract in Rust</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Writing a Basic Smart Contract in Rust</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-is-a-smart-contract">What is a Smart Contract?<a class="hash-link" href="#what-is-a-smart-contract" title="Direct link to heading">​</a></h2><p>A smart contract is a self-contained program installed on a blockchain. In the context of a Casper network, a smart contract consists of contract code installed on-chain using a <a href="/design/casper-design/#execution-semantics-deploys">Deploy</a>. Casper smart contracts are programs that run on a Casper network. They interact with accounts and other contracts through entry points, allowing for various triggers, conditions, and logic.</p><p>Smart contracts exist as stored on-chain logic, allowing disparate users to call the included entry points. These contracts can, in turn, call one another to perform interconnected operations and create more complex programs. The decentralized nature of blockchain technology means that these smart contracts do not suffer from any single point of failure. Even if a Casper node leaves the network, other nodes will continue to allow the contract to operate as intended.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="key-features-of-casper-contracts">Key Features of Casper Contracts<a class="hash-link" href="#key-features-of-casper-contracts" title="Direct link to heading">​</a></h2><p>On the Casper platform, developers may write smart contracts in any language that compiles to Wasm binaries. This tutorial focuses specifically on writing a smart contract in the Rust language. The Rust compiler compiles the contract code into Wasm. After that, the Wasm binary can be <a href="/dapp-dev-guide/writing-contracts/installing-contracts/">sent to a node</a> on a Casper network using a Deploy. Nodes within the network then <a href="/design/p2p/#communications-gossiping">gossip deploys</a>, include them within a block, and finalize them. After finalizing, the network executes the deploys within the block.</p><p>Further, the Casper platform allows for <a href="/dapp-dev-guide/writing-contracts/upgrading-contracts/">upgradable contracts</a>. A <a href="https://docs.rs/casper-types/latest/casper_types/contracts/struct.ContractPackage.html" target="_blank" rel="noopener noreferrer">ContractPackage</a> is created through the <a href="https://docs.rs/casper-contract/latest/casper_contract/contract_api/storage/fn.new_contract.html" target="_blank" rel="noopener noreferrer">new_contract</a> or <a href="https://docs.rs/casper-contract/latest/casper_contract/contract_api/storage/fn.new_locked_contract.html" target="_blank" rel="noopener noreferrer">new_locked_contract</a> methods. Through these methods, the Casper execution engine creates the new contract package automatically and assigns a <a href="/dapp-dev-guide/understanding-hash-types/#hash-and-key-explanations"><code>ContractPackageHash</code></a>. The new contract is added to this package with a <a href="https://docs.rs/casper-types/latest/casper_types/contracts/struct.ContractHash.html" target="_blank" rel="noopener noreferrer"><code>ContractHash</code></a> key. The execution engine stores the new contract within the contract package alongside any previously installed contract versions, if applicable.</p><p>The <code>new_contract</code> and <code>new_locked_contract</code> methods are a convenience that automatically creates the package associated with a new contract. Developers choosing not to use these methods must first create a contract package to function as a container for their new contract.</p><p>The contract contains required metadata, and it is primarily identified by its <code>ContractHash</code>. While the contract hash identifies a specific <a href="https://docs.rs/casper-types/latest/casper_types/contracts/type.ContractVersion.html" target="_blank" rel="noopener noreferrer">ContractVersion</a>, the <code>ContractPackageHash</code> serves as an identifier for the most recent contract version in the contract package.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="directory-structure">Creating the Directory Structure<a class="hash-link" href="#directory-structure" title="Direct link to heading">​</a></h2><p>To begin creating a smart contract, you need to set up the project structure, either manually or automatically, as shown below.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">project-directory/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── contract/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── src/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── main.rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── Cargo.toml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── tests/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── src/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── integration-tests.rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── Cargo.toml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="creating-the-project-manually">Creating the Project Manually<a class="hash-link" href="#creating-the-project-manually" title="Direct link to heading">​</a></h3><ol><li><p>Create a top-level project directory to store the contract code and its corresponding tests.</p></li><li><p>Create a folder for the contract code inside the project directory. This folder contains the logic that will be compiled into Wasm and executed on a Casper node. In this example, we named the folder <code>contract</code>. You can use a different folder name if you wish.</p><ul><li>In the <code>contract</code> folder, add a source folder called <code>src</code> and a <code>Cargo.toml</code> file, which specifies the contract&#x27;s dependencies.</li><li>Add a Rust file with the contract code in the <code>src</code> folder. In this example, we have the <code>main.rs</code> file.</li></ul></li><li><p>Navigating back to the project directory, create a folder for the tests, which help verify the contract&#x27;s functionality. In this example, we named the folder <code>tests</code>.</p><ul><li>In the <code>tests</code> folder, add a source folder called <code>src</code> and a <code>Cargo.toml</code> file, which specifies the required dependencies to run the tests.</li><li>In the <code>src</code> folder, add a Rust file with the tests that verify the contract&#x27;s behavior. In this example, we have the <code>integration-tests.rs</code> file.</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="creating-the-project-automatically">Creating the Project Automatically<a class="hash-link" href="#creating-the-project-automatically" title="Direct link to heading">​</a></h3><p>The <code>cargo casper</code> command can automatically set up the project structure, as shown <a href="/dapp-dev-guide/writing-contracts/getting-started/#creating-a-project">here</a>. Alternatively, follow the steps below to customize the project, yet create the various folders using <code>cargo</code>.</p><ol><li><p>Create a top-level project directory for the contract code and its corresponding tests.</p></li><li><p>Inside the project directory, run the following command to create a new binary package called <code>contract</code>. Use a different name instead of <code>contract</code> if you wish.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo new contract</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The command creates a <code>contract</code> folder with a <code>/src/main.rs</code> file and a <code>Cargo.toml</code> file:</p><ul><li><code>main.rs</code> - This file would contain the contract code.</li><li><code>Cargo.toml</code> - This file would contain crate dependencies and other configurations.</li></ul><p>The following sections explain how to update these files using example code.</p></li><li><p>Inside the project directory, run the command to auto-generate the folder structure for the tests. Use a different name instead of <code>tests</code> if you wish.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo new tests</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The command creates a <code>tests</code> folder with a <code>/src/main.rs</code> file and a <code>Cargo.toml</code> file:</p><ul><li><code>main.rs</code> - This file would store the unit test code required to test the contract. If you wish, you can rename the file to <code>integration-tests.rs</code> as shown in the example structure.</li><li><code>Cargo.toml</code> - This is the file with test configurations.</li></ul><p>The <a href="/dapp-dev-guide/writing-contracts/testing-contracts/">Testing Smart Contracts</a> guide explains how to update the tests using example code.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="writing-a-basic-smart-contract">Writing a Basic Smart Contract<a class="hash-link" href="#writing-a-basic-smart-contract" title="Direct link to heading">​</a></h2><p>This section covers the process of writing a smart contract in Rust, using example code from the <a href="https://github.com/casper-ecosystem/counter/" target="_blank" rel="noopener noreferrer">counter contract</a>. This simple contract allows callers to increment and retrieve an integer. Casper provides a <a href="https://docs.rs/casper-contract/latest/casper_contract/contract_api/index.html" target="_blank" rel="noopener noreferrer">contract API</a> within the <a href="https://docs.rs/casper-contract/latest/casper_contract/index.html" target="_blank" rel="noopener noreferrer"><code>casper_contract</code></a> crate.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="dependencies-in-cargotoml">Dependencies in <code>Cargo.toml</code><a class="hash-link" href="#dependencies-in-cargotoml" title="Direct link to heading">​</a></h3><p>The <code>Cargo.toml</code> file includes the dependencies and versions the contract requires. At a minimum, you need to import the latest versions of the <a href="https://docs.rs/casper-contract/latest/casper_contract/" target="_blank" rel="noopener noreferrer">casper-contract</a> and <a href="https://docs.rs/casper-types/latest/casper_types/" target="_blank" rel="noopener noreferrer">casper-types</a> crates. The following dependencies and version numbers are only examples and must be adjusted based on your requirements.</p><div class="codeBlockContainer_I0IT language-typescript theme-code-block"><div class="codeBlockContent_wNvx typescript"><pre tabindex="0" class="prism-code language-typescript codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">dependencies</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// A library for developing Casper network smart contracts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">casper</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">contract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.4.4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Types shared by many Casper crates for use on a Casper Network.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">casper</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">types </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.5.0&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><code>casper-contract = &quot;1.4.4&quot;</code> - Provides the SDK for the execution engine (EE). The latest version of the crate is published <a href="https://crates.io/crates/casper-contract" target="_blank" rel="noopener noreferrer">here</a>.</li><li><code>casper-types = &quot;1.5.0&quot;</code> - Includes types shared by many Casper crates for use on a Casper network. This crate is necessary for the EE to understand and interpret the session code. The latest version of the crate is published <a href="https://crates.io/crates/casper-types" target="_blank" rel="noopener noreferrer">here</a>.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="updating-the-mainrs-file">Updating the <code>main.rs</code> File<a class="hash-link" href="#updating-the-mainrs-file" title="Direct link to heading">​</a></h3><p>To begin writing contract code, add the following file attributes to support the Wasm execution environment. If you have an auto-generated <code>main.rs</code> file, remove the auto-generated main function.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#![no_std]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token attribute attr-name" style="color:#00a4db">#![no_main]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><code>#![no_main]</code> - This attribute tells the program not to use the standard main function as its entry point.</li><li><code>#![no_std]</code> - This attribute tells the program not to import the standard libraries.</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="defining-required-dependencies">Defining Required Dependencies<a class="hash-link" href="#defining-required-dependencies" title="Direct link to heading">​</a></h4><p>Add the required imports and dependencies. The example code for the counter contract declares the following dependencies.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// This code imports necessary aspects of external crates that we will use in our contract code.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">crate</span><span class="token plain"> </span><span class="token module-declaration namespace" style="opacity:0.7">alloc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Importing Rust types.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">alloc</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">string</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ToString</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">vec</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">Vec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Importing aspects of the Casper platform.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">casper_contract</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">contract_api</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> storage</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">unwrap_or_revert</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">UnwrapOrRevert</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Importing specific Casper types.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">casper_types</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">api_error</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">ApiError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">contracts</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">EntryPoint</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">EntryPointAccess</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">EntryPointType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">EntryPoints</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">NamedKeys</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">CLType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">CLValue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">URef</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="defining-the-global-constants">Defining the Global Constants<a class="hash-link" href="#defining-the-global-constants" title="Direct link to heading">​</a></h4><p>After importing the necessary dependencies, you should define the constants used within the contract, including entry points and values. The following example outlines the necessary constants for the counter contract.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Creating constants for values within the contract package.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CONTRACT_PACKAGE_NAME</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;counter_package_name&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CONTRACT_ACCESS_UREF</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;counter_access_uref&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Creating constants for the various contract entry points.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENTRY_POINT_COUNTER_INC</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;counter_inc&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENTRY_POINT_COUNTER_GET</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;counter_get&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Creating constants for values within the contract.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CONTRACT_VERSION_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CONTRACT_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;counter&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">COUNT_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;count&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="defining-the-contract-entry-points">Defining the Contract Entry Points<a class="hash-link" href="#defining-the-contract-entry-points" title="Direct link to heading">​</a></h4><p>Entry points provide access to contract code installed in global state. Either <a href="/dapp-dev-guide/writing-contracts/contract-vs-session/">session code</a> or another smart contract may call these entry points. A contract must have at least one entry point and may have more than one entry point. Entry points are defined by their name, and those names should be clear and self-describing. Each entry point is equivalent to a static main entry point in a traditional program.</p><p>Entry points are not functions or methods, and they have no arguments. They are static entry points into the contract&#x27;s logic. Yet, the contract logic can access parameters by name, passed along with the Deploy. Note that another smart contract may access any of these entry points.</p><p>If an entry point has one or more mandatory parameters that will cause the logic to revert if they are not included, declare them within that entry point. Optional and non-critical parameters should be excluded.</p><p>When defining entry points, begin with a <code>#[no_mangle]</code> line to ensure that the system does not change critical syntax within the method names. Each entry point should contain the contract code that drives the action you wish it to accomplish. Finally, include any storage or return values needed, as applicable.</p><p>The following entry point is an example from the counter contract. To see all the available entry points, review the contract in <a href="https://github.com/casper-ecosystem/counter/blob/master/contract-v1/src/main.rs" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token attribute attr-name" style="color:#00a4db">#[no_mangle]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">counter_inc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> uref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">URef</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">runtime</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">get_key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">COUNT_KEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap_or_revert_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ApiError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">MissingKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into_uref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap_or_revert_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ApiError</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">UnexpectedKeyVariant</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">storage</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uref</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Increment the count by 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="defining-the-call-function">Defining the <code>call</code> Function<a class="hash-link" href="#defining-the-call-function" title="Direct link to heading">​</a></h4><p>The <code>call</code> function starts the code execution and is responsible for installing the contract on-chain. In some cases, it also initializes some constructs, such as a Dictionary for record-keeping or a purse. The following steps describe how to structure the <code>call</code> function. Review the <a href="https://github.com/casper-ecosystem/counter/blob/8a622cd92d768893b9ef9fc2b150c674415be87e/contract-v1/src/main.rs#L55" target="_blank" rel="noopener noreferrer">call function</a> in the counter contract.</p><ol><li>Define the runtime arguments.</li></ol><p>At the time of contract installation, pass in parameters as runtime arguments. Use this pattern of variable definition to collect any sentinel values that dictate the behavior of the contract. If the entry point takes in arguments, you must declare those as part of the entry point&#x27;s definition.</p><p>Look at the <a href="https://github.com/casper-ecosystem/cep-78-enhanced-nft/blob/dev/contract/src/main.rs" target="_blank" rel="noopener noreferrer">CEP-78 contract</a> to see examples of entry points taking in arguments. The counter contract does not use variable parameters since it is too simple.</p><ol start="2"><li>Add the entry points into the <code>call</code> function.</li></ol><p>The <code>call</code> function replaces a traditional <code>main</code> function and executes automatically when a caller interacts with the contract. Within the <code>call</code> function, we define entry points that the caller can access using session code or another contract. When writing code that calls an entry point, there must be a one-to-one mapping of the entry point name. Otherwise, the execution engine will return an error that the entry point does not exist.</p><p>Each entry point should have these arguments:</p><ul><li><code>name</code> - The name of the entry point, which should be the same as the initial definition.</li><li><code>arguments</code> - A list of runtime arguments declared as part of the definition of the entry point.</li><li><code>return type</code> - The CLType that is returned by the entry point. Use the type <em>Unit</em> for empty return types.</li><li><code>access level</code> - Access permissions of the entry point.</li><li><code>entry point type</code> - This can be <code>contract</code> or <code>session</code> code.</li></ul><p>This step adds the individual entry points to a <code>counter_entry_points</code> object using the <code>add_entry_point</code> method. This object will later be passed to the <code>new_contract</code> method.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Create the entry points for this contract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> counter_entry_points </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">EntryPoints</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counter_entry_points</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add_entry_point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">EntryPoint</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token constant" style="color:#36acaa">ENTRY_POINT_COUNTER_GET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Vec</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">CLType</span><span class="token punctuation" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">I32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">EntryPointAccess</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Public</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">EntryPointType</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Contract</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counter_entry_points</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add_entry_point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">EntryPoint</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token constant" style="color:#36acaa">ENTRY_POINT_COUNTER_INC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Vec</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">CLType</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Unit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">EntryPointAccess</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Public</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">EntryPointType</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Contract</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ol start="3"><li>Create the contract&#x27;s named keys.</li></ol><p><a href="https://docs.rs/casper-types/latest/casper_types/contracts/type.NamedKeys.html" target="_blank" rel="noopener noreferrer">NamedKeys</a> are a collection of String-Key pairs used to easily identify some network data.</p><ul><li>The <a href="https://doc.rust-lang.org/nightly/alloc/string/struct.String.html" target="_blank" rel="noopener noreferrer">String</a> is the name given to identify the data</li><li>The <a href="https://docs.rs/casper-types/latest/casper_types/enum.Key.html" target="_blank" rel="noopener noreferrer">Key</a> is the data to be referenced</li></ul><p>You can create named keys to store any record or value as needed, such as other accounts, smart contracts, URefs, transfers, deploy information, purse balances, etc. The entire list of possible Key variants can be found <a href="https://docs.rs/casper-types/latest/casper_types/enum.Key.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>For the counter, we store the integer that we increment into a named key.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// In the named keys of the counter contract, add a key for the count.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> counter_named_keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">NamedKeys</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> key_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">COUNT_KEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counter_named_keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count_start</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ol start="4"><li>Create the contract.</li></ol><p>Use the <a href="https://docs.rs/casper-contract/latest/casper_contract/contract_api/storage/fn.new_contract.html" target="_blank" rel="noopener noreferrer">new_contract</a> method to create the contract, with its named keys and entry points. This method creates the contract object and saves the access URef and the contract package hash in the caller&#x27;s context. The execution engine automatically creates a contract package and assigns it a <code>contractPackageHash</code>. Then, it adds the contract to the package with a <a href="https://docs.rs/casper-types/latest/casper_types/contracts/struct.ContractHash.html" target="_blank" rel="noopener noreferrer"><code>contractHash</code></a>.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Create a new contract package that can be upgraded.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stored_contract_hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> contract_version</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">storage</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">new_contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counter_entry_points</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter_named_keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CONTRACT_PACKAGE_NAME</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CONTRACT_ACCESS_UREF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Usually, these contracts are upgradeable with the ability to add new <a href="https://docs.rs/casper-types/latest/casper_types/contracts/type.ContractVersion.html" target="_blank" rel="noopener noreferrer">versions</a>. To add a new contract version, you will need the access URef to the contract package. This can be accomplished by passing the <code>Some(CONTRACT_ACCESS_UREF.to_string())</code> argument to the <code>new_contract</code> method. To prevent any upgrades to a contract, use the <code>new_locked_contract</code> method described <a href="#locked-contracts">below</a>.</p><ol start="5"><li>Create additional named keys.</li></ol><p>Generally, the <code>Contract_Hash</code> and <code>Contract_Version</code> are saved as <code>NamedKeys</code> in the account&#x27;s context for later use.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Store the contract version in the context&#x27;s named keys.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> version_uref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">storage</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">new_uref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">contract_version</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">runtime</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">put_key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CONTRACT_VERSION_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> version_uref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Create a named key for the contract hash.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">runtime</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">put_key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CONTRACT_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stored_contract_hash</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="locked-contracts">Locked Contracts<a class="hash-link" href="#locked-contracts" title="Direct link to heading">​</a></h2><p>Locked contracts cannot contain other contract <a href="https://docs.rs/casper-types/latest/casper_types/contracts/type.ContractVersion.html" target="_blank" rel="noopener noreferrer">versions</a> in the same contract package; thus, they cannot be upgraded. In this scenario, the Casper execution engine will create a contract package, add a contract to that package and prevent any further upgrades to the contract. Use locked contracts when you need to ensure high security and will not require updates to the contract.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">new_locked_contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entry_points</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">EntryPoints</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    named_keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">NamedKeys</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hash_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uref_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">String</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ContractHash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ContractVersion</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">create_contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entry_points</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> named_keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hash_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uref_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><code>entry_points</code> - The set of entry points defined inside the smart contract.</li><li><code>named_keys</code> - Any <a href="https://docs.rs/casper-types/latest/casper_types/contracts/type.NamedKeys.html" target="_blank" rel="noopener noreferrer">named-key</a> pairs for the contract.</li><li><code>hash_name</code> - Contract hash value. Puts <a href="https://docs.rs/casper-types/latest/casper_types/contracts/struct.ContractHash.html" target="_blank" rel="noopener noreferrer">contractHash</a> in the current context&#x27;s named keys under <code>hash_name</code>.</li><li><code>uref_name</code> - Access URef value. Puts access_uref in the current context&#x27;s named keys under <code>uref_name</code>.</li></ul><p><strong>Note</strong>: The current context is the context of the person who initiated the <code>call</code> function, usually an account.</p><p>The counter contract in our example would be locked if we created it this way:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stored_contract_hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token namespace" style="opacity:0.7">storage</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">new_locked_contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter_entry_points</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Some</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter_named_keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="compiling-contract-code">Compiling Contract Code<a class="hash-link" href="#compiling-contract-code" title="Direct link to heading">​</a></h2><p>To compile the smart contract, run the following command in the directory hosting the <code>Cargo.toml</code> file and <code>src</code> folder.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo build --release --target wasm32-unknown-unknown</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>For the counter example, you may use the Makefile provided:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> build-contract</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="executing-contract-code">Executing Contract Code<a class="hash-link" href="#executing-contract-code" title="Direct link to heading">​</a></h2><p>Contract execution must be initiated through an outside call, usually via <a href="/dapp-dev-guide/writing-contracts/contract-vs-session/">session code</a> or another smart contract. Developers should also be familiar with the difference between contract code and session code, explained in the next section.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="video-walkthrough">Video Walkthrough<a class="hash-link" href="#video-walkthrough" title="Direct link to heading">​</a></h2><p>The following brief video accompanies this guide.</p><p align="center"><iframe width="400" height="225" src="https://www.youtube.com/embed?v=sUg0nh3K3iQ&amp;list=PL8oWxbJ-csEqi5FP87EJZViE2aLz6X1Mj&amp;index=6" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="whats-next">What&#x27;s Next?<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><ul><li>Learn to <a href="/dapp-dev-guide/writing-contracts/testing-contracts/">test your contract</a>.</li><li>Understand <a href="/dapp-dev-guide/writing-contracts/contract-vs-session/">session code</a> and how it triggers a smart contract.</li><li>Learn to <a href="/dapp-dev-guide/writing-contracts/installing-contracts/">install a contract and query global state</a> with the Casper command-line client.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casper-network/docs/tree/main/source/docs/casper/dapp-dev-guide/writing-contracts/rust-contracts.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-01-27T09:55:42.000Z">1/27/2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dapp-dev-guide/writing-contracts/best-practices/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Best Practices for Casper Smart Contract Authors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dapp-dev-guide/writing-contracts/testing-contracts/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Smart Contracts</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-smart-contract" class="table-of-contents__link toc-highlight">What is a Smart Contract?</a></li><li><a href="#key-features-of-casper-contracts" class="table-of-contents__link toc-highlight">Key Features of Casper Contracts</a></li><li><a href="#directory-structure" class="table-of-contents__link toc-highlight">Creating the Directory Structure</a><ul><li><a href="#creating-the-project-manually" class="table-of-contents__link toc-highlight">Creating the Project Manually</a></li><li><a href="#creating-the-project-automatically" class="table-of-contents__link toc-highlight">Creating the Project Automatically</a></li></ul></li><li><a href="#writing-a-basic-smart-contract" class="table-of-contents__link toc-highlight">Writing a Basic Smart Contract</a><ul><li><a href="#dependencies-in-cargotoml" class="table-of-contents__link toc-highlight">Dependencies in <code>Cargo.toml</code></a></li><li><a href="#updating-the-mainrs-file" class="table-of-contents__link toc-highlight">Updating the <code>main.rs</code> File</a></li></ul></li><li><a href="#locked-contracts" class="table-of-contents__link toc-highlight">Locked Contracts</a></li><li><a href="#compiling-contract-code" class="table-of-contents__link toc-highlight">Compiling Contract Code</a></li><li><a href="#executing-contract-code" class="table-of-contents__link toc-highlight">Executing Contract Code</a></li><li><a href="#video-walkthrough" class="table-of-contents__link toc-highlight">Video Walkthrough</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next?</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><div class="footer-inner-container">
    <div class="footer-top">
        <ul class="items">
            <li><a href="https://arxiv.org/pdf/2101.02159.pdf" target="_blank" rel="noopener">White Paper</a></li>
            <li>
                <a href="https://docs.casperlabs.io" target="_blank" rel="noopener"> Docs </a>
            </li>
            <li><a href="https://devxdao.com/" target="_blank" rel="noopener">Grant Program</a></li>
            <li><a href="https://casper.network/network/casper-association" target="_blank" rel="noopener">Casper Association</a></li>
        </ul>
    </div>
    <div class="footer-bottom">
        <ul class="items left">
            <li>
                <a href="https://casper.network/en/network" target="_blank" rel="noopener">
                    <img class="footer-logo" src="/icon/Casper_Wordmark_White_RGB.png" alt="Casper Logo">
                </a>
            </li>
            <li>© 2023 Casper Association</li>
        </ul>
        <ul class="items right">
            <li class="trademark">
                <a href="https://casper.network/network/trademark-policy" target="_blank" rel="noopener">Trademark Policy and Guidelines</a>
            </li>
        </ul>
    </div>
</div>
</div></div></div></footer></div>
<script src="/assets/js/runtime~main.aea1ae3e.js"></script>
<script src="/assets/js/main.aa97aa2a.js"></script>
</body>
</html>